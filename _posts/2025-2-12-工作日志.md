---
category: daily
layout: post_layout
title: 2.11工作日志
time: 2025年2月10日 星期二
location: 杭州
pulished: true
excerpt_separator: "#"
---



由于在去年的时候已经熟悉过erda-infra框架，昨天下午也大概的了解了整个重构的需求和目的。今天开始编码。



# erda统一鉴权重构



## 编写proto文件

首先我针对路由，已经每个handlers的入参和返回值。编写proto文件。在编写的过程中遇到了一些问题。之前写自己写项目的时候编写的proto文件，相对来说简单一些，没有遇到过一些负载的类型。这次的编写过程中。遇到了一些阻碍。像interface，多重嵌套的结构体，自定义类型(string的枚举类型)



在我差不多写完80%的接口的时候，我遇到一个需要依赖其他proto文件的返回值类型。我问了一下我师兄如何处理。不问还好，一问才发现一个更大的问题。我发现这个模块之前已经部分重构过了的。我师兄说是之前的一个P8主管对这个模块，已经部分封装到了erda-infra的pb里面。但是还是没有做鉴权的。这下给我整懵逼了。



好吧，没有办法，毕竟是我的工作。那么现在开始整理一下，之前这位P8主管重构了一些什么内容，避免自己重构的代码和之前的发生冲突。





